<%# app/views/projects/_project_slider.html.erb %>

<div id="projectSlider" class="carousel slide" data-ride="false">
  <ol class="carousel-indicators">
    <% (0...@project.images.length).to_a.each do |i| %>
      <li
        data-target="#projectSlider"
        data-slide-to="<%= i %>"
        class="<%= i.zero? ? 'active' : ''  %>"
      ></li>
    <% end %>
  </ol>

  <div class="carousel-inner">
    <% @project.images.each_with_index do |image, index| %>
      <div class="<%= index.zero? ? 'carousel-item active' : 'carousel-item' %>">
        <img class="d-block w-100" src="<%= image %>" alt="First slide">
      </div>
    <% end %>
  </div>

  <a
    class="carousel-control-prev"
    href="#projectSlider"
    role="button"
    data-slide="prev"
  >
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>

  <a
    class="carousel-control-next"
    href="#projectSlider"
    role="button"
    data-slide="next"
  >
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
</div>

<script>
  $(document).ready(function() {
    var $slider = $('#projectSlider');
    var $buttons = $('.carousel-control-prev, .carousel-control-next');

    // Pause the carousel when the slide animation finishes
    $slider.on('slide.bs.carousel', function() {
      $slider.carousel('pause');
    });

    // Remove the focus state on mouse leave
    // so the opacity returns to 0.5
    $buttons.on('mouseleave', function() {
      $(this).blur();
    });
  });
</script>
